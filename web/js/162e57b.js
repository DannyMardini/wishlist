var selectedEventId=null;var eventListEmptyMessage='<p class="message">You don\'t have any events! To add an event click the (+) button above!<br/><br />Event examples: your birthday, an anniversary, christmas, etc</p>';var couldNotRemoveEventMessage="Event could not be removed. Contact the Wishlist support if the issue persists.";var couldNotSaveEventMessage="The save could not be processed. Contact the wishlist support if the issue persists.";$(document).ready(function(){createGUIButtons();createGUIDialogs();setupEventHandlers();checkIfEmptyMessageRequired()});function setupEventHandlers(){applyEventHoverHandler($(".Event"));$("#saveNewEvent").click(onClickSaveEventHandler)}function createGUIButtons(){$("#addLifeEventButton").button({icons:{primary:"ui-icon-plusthick"},text:false}).click(function(){clearNewEventPanel();$("#newEventPanel").dialog("open")});$("#addLifeEventButton").css("height","25");setupRemoveEventButtons($(".remove"))}function clearNewEventPanel(){$("#newEventname").val("");$("#newEventMonth").val("");$("#newEventDay").val("");$("#newEventType").val("-1")}function createGUIDialogs(){$("#newEventPanel").dialog({position:"top",modal:true,autoOpen:false,title:"New Event",draggable:false,resizable:false});$("#dialog-message").dialog({position:"top",autoOpen:false,resizable:false,height:230,modal:true,buttons:{Ok:function(){$(this).dialog("close")}}});$("#dialog-confirm").dialog({position:"top",autoOpen:false,resizable:false,height:230,modal:true,buttons:{Continue:function(){removeEvent();$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})}function setupRemoveEventButtons(a){a.button({icons:{primary:"ui-icon-closethick"},text:false}).click(onClickRemoveEventHandler);a.css("height","55").css("width","45")}function applyEventHoverHandler(a){$(a).hover(function(){onEventHoverHandler(this)},function(){onEventHoverOutHandler(this)})}function onEventHoverOutHandler(a){$(a).removeClass("focusEvent");$(".remove",$(a)).hide();$(".edit",$(a)).hide()}function onEventHoverHandler(a){$(a).addClass("focusEvent");$(".remove",$(a)).show();$(".edit",$(a)).show()}function onClickRemoveEventHandler(b,a){selectedEventId=b.currentTarget.id.split("_")[2];if(selectedEventId===undefined){return false}$("#dialog-confirm").dialog("open")}function removeEvent(){if(!selectedEventId){$("#dialog-message").attr("title","An issue occurred!").html("<p>"+couldNotRemoveEventMessage+"</p>").dialog("open")}ajaxCall(Routing.generate("WishlistUserBundle_removeEvent"),{id:selectedEventId},removeEventCallback)}function checkIfEmptyMessageRequired(){var a=getEventCount();if(a==0){$("#EventList").html(eventListEmptyMessage)}}function removeEventCallback(a){if(a=="0"){$("#dialog-message").attr("title","An issue occurred!").html("<p>"+couldNotRemoveEventMessage+"</p>").dialog("open");return}$("#event_"+a).remove();checkIfEmptyMessageRequired();updateEventCountSpan();$("#dialog-message").dialog("option","title","Event Removed!");$("#dialog-message").dialog("open");$("#dialog-message").html("<p>The event was permanently removed.</p>");selectedEventId=null}function onClickSaveEventHandler(a){try{a.preventDefault();if(!validateNewEventInputs()){alert("Invalid inputs");return}saveNewEvent();$("#newEventPanel").dialog("close")}catch(a){alert(a)}}function saveNewEvent(){var a=$("#newEventname").val();var c=$("#newEventMonth").val();var b=$("#newEventDay").val();var d=$("#newEventType option:selected").val();ajaxPost({name:a,month:c,day:b,type:d},Routing.generate("WishlistUserBundle_saveEvent"),saveNewEventCallback)}function saveNewEventCallback(a){try{if(a.toLowerCase().indexOf("issue")>-1){throw couldNotSaveEventMessage}renderNewEvent(a);updateEventCountSpan();$("#dialog-message").attr("title","Event saved!").html("<p>The event was saved.</p>").dialog("open")}catch(b){$("#dialog-message").attr("title","An issue occurred!").html("<p>"+b+"</p>").dialog("open")}}function validateNewEventInputs(){return($("#newEventname").val()!=""&&$("#newDatepicker").val()!=""&&$("#newEventType option:selected").val()!=-1)}function getEventCount(){return $("div.Event").length}function updateEventCountSpan(){$("#eventCount").html(getEventCount())}function renderNewEvent(d){var a=getEventCount();if(a==0){$("#EventList").html("")}var b=$("#newEventType").val();var f=$("#newEventname").val();var g=b==1?"/images/birthday1.png":(b==2?"/images/anniversary4.gif":"/images/otherEvent.jpeg");var c=$("#newEventMonth").val();var i=$("#newEventDay").val();var j=parseDate(c+"/"+i+"/"+2004);var h=j.getDate();var e=["<div class='Event' id='event_",d,"'><button id='remove_event_",d,"' class='remove' title='remove event'><span class='ui-icon ui-icon-minus wishenda-button'></span></button>",,"<div class='image' title='",f,"'><img src='",g,"' height='30' width='30' /></div>",,"<div class='name' title ='",f,"'>",f,"</div>",,"<div class='timestamp' title='",f,"'>-- ",month[j.getMonth()]," ",h,get_nth_suffix(h),"</div></div>"].join("");$("#EventList").prepend(e);$("#newEventname").val("");$("#newDatepicker").val("");$("#newEventType :selected").removeAttr("selected");$("option[value=-1]","#newEventType").attr("selected","selected");setupRemoveEventButtons($("#remove_event_"+d));applyEventHoverHandler($("#event_"+d))};